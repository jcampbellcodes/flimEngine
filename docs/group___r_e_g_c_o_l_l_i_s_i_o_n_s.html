<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>flimEngine: Register For Collision</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">flimEngine
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group___r_e_g_c_o_l_l_i_s_i_o_n_s.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Register For Collision<div class="ingroups"><a class="el" href="group___g_e_t_t_i_n_g_s_t_a_r_t_e_d.html">Getting Started</a> &raquo; <a class="el" href="group___g_o_p_r_o_p_s.html">Register GameObject Properties</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>How to register GameObjects for collision.  
<a href="#details">More...</a></p>
<div class="dynheader">
Collaboration diagram for Register For Collision:</div>
<div class="dyncontent">
<center><table><tr><td><img src="group___r_e_g_c_o_l_l_i_s_i_o_n_s.png" border="0" alt="" usemap="#group______r__e__g__c__o__l__l__i__s__i__o__n__s"/>
<map name="group______r__e__g__c__o__l__l__i__s__i__o__n__s" id="group______r__e__g__c__o__l__l__i__s__i__o__n__s">
<area shape="rect" id="node2" href="group___g_o_p_r_o_p_s.html" title="GameObjects have extra properties that they can be registered for, such as Alarms (callbacks that fir..." alt="" coords="5,5,152,47"/>
</map>
</td></tr></table></center>
</div>
<p>How to register GameObjects for collision. </p>
<p>GameObjects that have models can register for collisions with other GameObjects, and there are several steps for registration.</p>
<p>First, GameOjet types must be registered as collidable in some sort of initialization code. For example, we could do it in the <a class="el" href="group___s_c_e_n_e_s.html#ga7e9bd80ea57df93521d69d126d1ce54a" title="Initializes this object. ">Scene::Initialize</a> of our FirstScene</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="_collision_manager_8h.html">Flim/CollisionManager.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="_frigate_8h.html">Frigate.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="_cottage_8h.html">Cottage.h</a>&quot;</span></div><div class="line"></div><div class="line"><a class="code" href="_flim_2err_8h.html#a343133541366e7103c3d6a5ffe3dbe50">errcode</a> <a class="code" href="class_scene_demo.html#a097d6c32040db63e2498a7350d05db37">SceneDemo::Initialize</a>()</div><div class="line">{</div><div class="line"></div><div class="line">    <span class="comment">// Allows frigates to register for collision with other frigates</span></div><div class="line">    SetCollisionSelf&lt;Frigate&gt;();</div><div class="line"></div><div class="line">    <span class="comment">// Allows cottages and frigates to register for collisions with one another</span></div><div class="line">    SetCollisionPair&lt;Cottage, Frigate&gt;();</div><div class="line"></div><div class="line">    <span class="comment">// Allows Frigates to collide with the Terrain</span></div><div class="line">    SetCollisionTerrain&lt;Frigate&gt;();</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> <a class="code" href="_flim_2err_8h.html#a343133541366e7103c3d6a5ffe3dbe50ab8916948582bbb4902d6ad269064f7ef">errcode::success</a>;</div><div class="line">}</div></div><!-- fragment --><p>Then, the GameObjects themselves need to declare the callbacks for the collision events.</p>
<p>Our <a class="el" href="class_frigate.html">Frigate</a>, for example, would define a callback for collisions with Cottages and other Frigates.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;AzulCore.h&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="_game_object_8h.html">Flim/GameObject.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="keyword">class </span><a class="code" href="class_frigate.html">Frigate</a> : <span class="keyword">public</span> <a class="code" href="class_game_object.html">GameObject</a></div><div class="line">{</div><div class="line"><span class="comment">//...</span></div><div class="line"></div><div class="line">    <span class="keyword">virtual</span> <a class="code" href="_flim_2err_8h.html#a343133541366e7103c3d6a5ffe3dbe50">errcode</a> <a class="code" href="class_frigate.html#ad9125ddd1667fc74e1a130b0e3d7ce61">Collision</a>(<a class="code" href="class_frigate.html">Frigate</a>*)</div><div class="line">    {</div><div class="line">        DebugMsg::out(<span class="stringliteral">&quot;Collision Frigate with Frigate\n&quot;</span>);</div><div class="line">        <span class="keywordflow">return</span> <a class="code" href="_flim_2err_8h.html#a343133541366e7103c3d6a5ffe3dbe50ab8916948582bbb4902d6ad269064f7ef">errcode::success</a>;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keyword">virtual</span> <a class="code" href="_flim_2err_8h.html#a343133541366e7103c3d6a5ffe3dbe50">errcode</a> <a class="code" href="group___c_o_l_l_i_s_i_o_n_c_a_l_l_b_a_c_k_s.html#ga2bda804eb378b7a36982cea8cee8ac34">CollisionEnter</a>(<a class="code" href="class_cottage.html">Cottage</a>*)</div><div class="line">    {</div><div class="line">        DebugMsg::out(<span class="stringliteral">&quot;Collision Entered With Cottage\n&quot;</span>);</div><div class="line">        <span class="keywordflow">return</span> <a class="code" href="_flim_2err_8h.html#a343133541366e7103c3d6a5ffe3dbe50ab8916948582bbb4902d6ad269064f7ef">errcode::success</a>;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keyword">virtual</span> <a class="code" href="_flim_2err_8h.html#a343133541366e7103c3d6a5ffe3dbe50">errcode</a> <a class="code" href="group___c_o_l_l_i_s_i_o_n_c_a_l_l_b_a_c_k_s.html#gac228d483da59b8823bd5574460c904cc">CollisionExit</a>()</div><div class="line">    {</div><div class="line">        DebugMsg::out(<span class="stringliteral">&quot;Frigate just stopped colliding.\n&quot;</span>);</div><div class="line">        <span class="keywordflow">return</span> <a class="code" href="_flim_2err_8h.html#a343133541366e7103c3d6a5ffe3dbe50ab8916948582bbb4902d6ad269064f7ef">errcode::success</a>;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keyword">virtual</span> <a class="code" href="_flim_2err_8h.html#a343133541366e7103c3d6a5ffe3dbe50">errcode</a> <a class="code" href="class_frigate.html#ac7b66a9446a4d484017985bd370bb4e5">CollisionTerrain</a>(<span class="keyword">const</span> <a class="code" href="class_collision_volume_a_a_b_b.html">CollisionVolumeAABB</a>&amp;)</div><div class="line">    {</div><div class="line">        DebugMsg::out(<span class="stringliteral">&quot;Frigate collides with Terrain, and here is the AABB that caused the collision\n&quot;</span>);</div><div class="line">        <span class="keywordflow">return</span> <a class="code" href="_flim_2err_8h.html#a343133541366e7103c3d6a5ffe3dbe50ab8916948582bbb4902d6ad269064f7ef">errcode::success</a>;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keyword">virtual</span> <a class="code" href="_flim_2err_8h.html#a343133541366e7103c3d6a5ffe3dbe50">errcode</a> <a class="code" href="class_frigate.html#ad9125ddd1667fc74e1a130b0e3d7ce61">Collision</a>(<a class="code" href="class_cottage.html">Cottage</a>*)</div><div class="line">    {</div><div class="line">        DebugMsg::out(<span class="stringliteral">&quot;Collision Frigate with Frigate\n&quot;</span>);</div><div class="line">        <span class="keywordflow">return</span> <a class="code" href="_flim_2err_8h.html#a343133541366e7103c3d6a5ffe3dbe50ab8916948582bbb4902d6ad269064f7ef">errcode::success</a>;</div><div class="line">    }</div><div class="line"><span class="comment">//...</span></div><div class="line">};</div></div><!-- fragment --><p>And finally, some bookkeeping must be done so the collision system knows about the <a class="el" href="class_game_object.html">GameObject</a>'s model. You need to register, deregister for collisions, set the model to be used for collision, and continually tell the collision system about the model's world matrix (if the model will move);</p>
<div class="fragment"><div class="line"><a class="code" href="class_frigate.html#ad68c1d421cc3872688a19727055632a2">Frigate::Frigate</a>()</div><div class="line">{</div><div class="line">    <span class="comment">// set model to be used for collision</span></div><div class="line">    <span class="comment">// Four collision volumes are available: OBB, AABB, BSphere, and OcclusionLine</span></div><div class="line">    <a class="code" href="group___c_o_l_l_i_s_i_o_n_s.html#gac845517463c360e080800d6af48702ac">SetColliderModel</a>(<a class="code" href="class_frigate.html#a5210853e7ea5df85e5a5e3bc7ea871c7">pGObj_SpaceFrigateLight</a>-&gt;getModel(), <a class="code" href="_collidable_8h.html#ga930cd371d87ebbf3b921dadc5ca2b4aba9aac15e014ce3a36fcbf4a3f669332da">VolumeType::OBB</a>);</div><div class="line"></div><div class="line">}</div></div><!-- fragment --><div class="fragment"><div class="line"><a class="code" href="_flim_2err_8h.html#a343133541366e7103c3d6a5ffe3dbe50">errcode</a> <a class="code" href="class_frigate.html#a5f61a8085854f39b1849bb0556a38b62">Frigate::Update</a>()</div><div class="line">{</div><div class="line">    <span class="comment">//...</span></div><div class="line">    <span class="comment">// however you are calculating the world matrix of the model</span></div><div class="line">    Matrix world = <a class="code" href="class_frigate.html#acc24919f01132af7fc223242cae306fe">ShipScale</a> * <a class="code" href="class_frigate.html#ad4cafb47a95ef7d73d631f32ac8a1f2d">ShipRot</a> * Matrix(TRANS, <a class="code" href="class_frigate.html#a8be34d57c5dc9108c34bb2a89c8ed6fb">ShipPos</a>);</div><div class="line">    <a class="code" href="class_frigate.html#a5210853e7ea5df85e5a5e3bc7ea871c7">pGObj_SpaceFrigateLight</a>-&gt;SetWorld(world);</div><div class="line"></div><div class="line">    <span class="comment">// give that world matrix to the collision system</span></div><div class="line">    <a class="code" href="group___c_o_l_l_i_s_i_o_n_s.html#ga23e644bafd4b8ca0909830112efa0103">UpdateCollisionData</a>(world);</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> <a class="code" href="_flim_2err_8h.html#a343133541366e7103c3d6a5ffe3dbe50ab8916948582bbb4902d6ad269064f7ef">errcode::success</a>;</div><div class="line">}</div></div><!-- fragment --> <div class="fragment"><div class="line"><a class="code" href="_flim_2err_8h.html#a343133541366e7103c3d6a5ffe3dbe50">errcode</a> <a class="code" href="class_frigate.html#ae3fbb4833f929ee88c9208fffe3d6be9">Frigate::SceneEntry</a>()</div><div class="line">{</div><div class="line">    <span class="comment">// submit yourself for registration</span></div><div class="line">    SubmitCollisionRegistration&lt;Frigate&gt;(<span class="keyword">this</span>);</div><div class="line">    <span class="keywordflow">return</span> <a class="code" href="_flim_2err_8h.html#a343133541366e7103c3d6a5ffe3dbe50ab8916948582bbb4902d6ad269064f7ef">errcode::success</a>;</div><div class="line"></div><div class="line">}</div></div><!-- fragment --> <div class="fragment"><div class="line"><a class="code" href="_flim_2err_8h.html#a343133541366e7103c3d6a5ffe3dbe50">errcode</a> <a class="code" href="class_frigate.html#aab1829d886e30981f5a89af5c5ec4c68">Frigate::SceneExit</a>()</div><div class="line">{</div><div class="line"></div><div class="line">    <span class="comment">// submit yourself for deregistration</span></div><div class="line">    SubmitCollisionDeregistration&lt;Frigate&gt;(<span class="keyword">this</span>);</div><div class="line">    <span class="keywordflow">return</span> <a class="code" href="_flim_2err_8h.html#a343133541366e7103c3d6a5ffe3dbe50ab8916948582bbb4902d6ad269064f7ef">errcode::success</a>;</div><div class="line">}</div></div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
